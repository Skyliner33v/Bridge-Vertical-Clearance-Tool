<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style>
        html,
        body {
            font-family: Arial, sans-serif;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .container {
            height: 100%;
            position: relative;
        }

        input {
            font-size: 12px;
        }

        h1 {
            font-size: 22px;
            margin: 0 0 10px 0;
            text-align: center;
        }

        #routeInfo {
            font-size: 12px;
        }

        #map {
            bottom: 0px;
            height: 100%;
            left: 500px;
            position: absolute;
            right: 0px;
        }

        .options-box {
            background: #fff;
            border: 1px solid #999;
            border-radius: 3px;
            height: 100%;
            line-height: 35px;
            padding: 10px 10px 30px 10px;
            text-align: left;
            width: 478px;
            overflow-y: scroll;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="options-box">
            <h1>Washington Bridge Vertical Clearances</h1>
            <div>
                <input id="inputRoute" type="text" placeholder="Enter 3 digit route ex 005">
                <input type="button" value="Get Route" onclick="getRoute()">
                <div id="routeInfo"></div>
            </div>
        </div>
        <div id="map"></div>
    </div>


    <script>
        // Create blank arrays for placing markers
        var markers = [];
        var placeMarkers = [];

        // Initialize map on page, centered on WA state
        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                center: {
                    lat: 47.591103,
                    lng: -120.767221
                },
                zoom: 8,
                mapTypeId: 'roadmap'
            });
        }

        //AJAX call to WSDOT api to get route specific bridge clearance info
        function getRoute() {

            //Clear out old route info first
            var clearRoutes = "";
            document.getElementById("routeInfo").innerHTML = clearRoutes;  

            //Initilize call from user input
            var route = $('#inputRoute').val();
            var key = "59a077ad-7ee3-49f8-9966-95a788d7052f"
            var url = "https://wsdot.wa.gov/Traffic/api/Bridges/ClearanceREST.svc/GetClearancesAsJson?AccessCode=" +
                key + "&Route=" + route;

            //Call to WSDOT API
            $.ajax({
                url: url,
                dataType: 'jsonp',
                success: function (data) {
                    var retValue = "";
                    var i = 0
                    for (i; i < data.length; i++) {  

                        //We only want Under records where Begin and End Coordinates are the same
                        if (data[i].BeginLatitude===data[i].EndLatitude && data[i].BeginLongitude===data[i].EndLongitude) {
                            retValue +=
                                data[i].BridgeName + " Begin Lat = " + data[i].BeginLatitude + " Begin Long = " +
                                data[i].BeginLongitude + "<br>" +
                                "Minimun Vertical Clearance = " + data[i].MinimumVerticalClearance + "<br>"
                        }
                    }

                    //Add returned info to page
                    document.getElementById("routeInfo").innerHTML = retValue;
                }
            });

        }
    </script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?libraries=places,geometry,drawing&key=AIzaSyBnHYpw5I8E40V2gAEO5iRawpmbXJdea5I&v=3&callback=initMap">
    </script>
</body>

</html>